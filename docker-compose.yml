services:
    backend:
        build: ./backend
        ports:
            - '8000:8000'
        environment:
            - CORS_ORIGINS=${CORS_ORIGINS}
        volumes:
            - ./backend/data:/app/backend/data
        restart: unless-stopped
        healthcheck:
            test: ['CMD', 'curl', '-f', 'http://localhost:8000/']
            interval: 30s
            timeout: 10s
            retries: 3
        networks:
            - app-network

    frontend:
        build:
            context: ./frontend
            args:
                - VITE_BASE_PATH=${VITE_BASE_PATH}
                - VITE_API_BASE_URL=${VITE_API_BASE_URL}
        ports:
            - '3000:80'
        depends_on:
            - backend
        restart: unless-stopped
        networks:
            - app-network

networks:
    app-network:
        driver: bridge
